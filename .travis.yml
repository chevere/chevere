dist: focal

language: php

php:
  - nightly

matrix:
  allow_failures:
    - php: nightly

cache:
  directories:
    - "$HOME/.composer/cache"

before_install:
  - pecl install ds
  - phpenv config-add chevere.ini
  - composer validate

addons:
  sonarcloud:
    organization: "chevere"
    token:
      secure: "F84N4oD1E11gJ+4j1xmkQU5dui0zi8sxXoPV+z4xrmqdDrcYYHIJTfOjpUg6nQf9iCcT0ZWXGlL+LTcguqrKUp4vWIdKpSaFqqzdLhvnKN+360FxWXkHZWdfiMeYL5TQBrwZ9unW6xc9EdB244wugPLNhH9GFEYEchRIR3rcHidu2cJb781uN4pDXlNDRcJi1zFYxXE6c1MfsVqVboJdu2q9hX3/AqHFcw3J0t7X7M0CAIqCVA4c+acgotfU19ci5gtdIa1QzdHrG/j4Y+/BDTRP7uVkZdcIo0IZRQi9NXmrCBrXUGkj3ut6RG2Q2K9hj/Onh9Unjcp+CS/lRz0dR3ygKcTO3HWnAUTOzpWGow8/x3Zi7Mzbqprh+yn3bWpEmKQgR4ixWado0zzCq+oamDbc8WRCAIuLXyDzR1GO0YGH5V+ROOji3uLLl9J5irWHmacC7poDczxOccbwcB+iwxgiCb1uo21lkovbgKMmcu6CMWN/xUhcBn8YVqKUpxlHjVnAFeoLW6xfBHn8drtt/oQXMtQKprw9eUZK6B9BH4MgoIypNI22spl39KEMHPYrP/qlri0U/S0nBqVhGMg2qUTuEAQaIbaa/voc/u+Vof+2zeVppnz8jeZoXgViUGXKNVf9eyNV8akx2FbmFBijCx0iF1ErF4qIx0v9X/uncdo="

install:
  - composer install --prefer-dist --no-progress --classmap-authoritative --ignore-platform-reqs

script:
  - vendor/bin/phpunit --coverage-clover=build/coverage/clover.xml
  - sonar-scanner
